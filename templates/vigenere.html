<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Vigenere Cipher</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function copyText() {
      const text = document.getElementById("cipherResult").innerText;
      navigator.clipboard.writeText(text);
    }
  </script>
</head>
<body class="bg-white text-white flex justify-center items-center min-h-screen">
   <div class="bg-gray-900 p-8 rounded-lg shadow-md w-full max-w-2xl">
    <h1 class="text-2xl text-center font-bold text-blue-500 mb-4">Vigenere Cipher</h1>

    <!-- Form Input -->
    <form method="POST" class="space-y-4">
      <textarea name="text" placeholder="Masukkan teks" class="w-full p-3 rounded bg-gray-800 text-white">{{ request.form.get('text', '') }}</textarea>

      <input type="text" name="key" placeholder="Masukkan key" 
             value="{{ request.form.get('key', '') }}" 
             class="w-full p-3 rounded bg-gray-800 text-white"/>

      <select name="mode" class="w-full p-3 rounded bg-gray-800 text-white">
        <option value="encrypt" {% if request.form.get('mode') == 'encrypt' %}selected{% endif %}>Enkripsi</option>
        <option value="decrypt" {% if request.form.get('mode') == 'decrypt' %}selected{% endif %}>Dekripsi</option>
      </select>

      <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg hover:bg-blue-700">Proses</button>
    </form>

    <!-- Hasil Enkripsi -->
    {% if result %}
    <div class="mt-6 bg-gray-800 p-4 rounded">
      <p class="font-semibold text-lg mb-1 text-blue-400">Hasil:</p>
      <p id="cipherResult" class="text-xl tracking-wider">{{ result }}</p>
      <button onclick="copyText()" class="mt-3 px-3 py-1 bg-green-600 rounded hover:bg-green-700">Copy</button>
    </div>

    <!-- Tabel Perhitungan -->
    <div class="mt-6 bg-gray-800 p-4 rounded">
      <p class="font-semibold text-lg mb-3 text-blue-400">Proses Perhitungan:</p>
      <div class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-300 border border-gray-700">
          <thead class="bg-gray-700 text-gray-100">
            <tr>
              <th class="px-3 py-2 border border-gray-600">No</th>
              <th class="px-3 py-2 border border-gray-600">P</th>
              <th class="px-3 py-2 border border-gray-600">K</th>
              <th class="px-3 py-2 border border-gray-600">(P + K) mod 26</th>
              <th class="px-3 py-2 border border-gray-600">Hasil (angka)</th>
              <th class="px-3 py-2 border border-gray-600">Hasil (huruf)</th>
            </tr>
          </thead>
          <tbody>
            {% for step in process %}
            <tr class="hover:bg-gray-700">
              <td class="px-3 py-2 border border-gray-700">{{ loop.index }}</td>
              <td class="px-3 py-2 border border-gray-700">{{ step.P }}</td>
              <td class="px-3 py-2 border border-gray-700">{{ step.K }}</td>
              <td class="px-3 py-2 border border-gray-700">({{ step.P }} + {{ step.K }}) mod 26 = {{ step.hasil }}</td>
              <td class="px-3 py-2 border border-gray-700">{{ step.hasil }}</td>
              <td class="px-3 py-2 border border-gray-700 font-semibold text-blue-400">{{ step.char }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

  <!-- Hasil -->
<div class="mt-6 bg-gray-800 p-4 rounded">
  <p class="font-semibold text-lg mb-3 text-blue-400">Hasil</p>

  <p><span class="font-semibold text-gray-300">Plaintext:</span> 
    <span class="text-white">{{ request.form.get('text', '') }}</span>
  </p>

  <p><span class="font-semibold text-gray-300">Key:</span> 
    <span class="text-white">{{ request.form.get('key', '') }}</span>
  </p>

  <p><span class="font-semibold text-gray-300">Ciphertext:</span> 
    <span class="text-blue-400 font-bold text-lg">{{ result }}</span>
  </p>
</div>

    </div>
    {% endif %}
  </div>
</body>
</html>
