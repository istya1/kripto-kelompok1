<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Stream Cipher (LFSR)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function copyText() {
      const text = document.getElementById("cipherResult").innerText;
      navigator.clipboard.writeText(text);
    }
  </script>
</head>
<body class="bg-white text-white flex justify-center items-center min-h-screen">
  <div class="bg-gray-900 p-8 rounded-lg shadow-md w-full max-w-lg">
    <h1 class="text-2xl text-center font-bold text-blue-500 mb-4">Stream Cipher (LFSR)</h1>

    <!-- Form -->
    <form method="POST" class="space-y-4">
      <textarea name="text" placeholder="Masukkan plaintext/ciphertext"
                class="w-full p-3 rounded bg-gray-800 text-white">{{ text }}</textarea>

      <input type="text" name="key" placeholder="Masukkan key (seed)"
             value="{{ key }}"
             class="w-full p-3 rounded bg-gray-800 text-white"/>

      <select name="mode" class="w-full p-3 rounded bg-gray-800 text-white">
        <option value="encrypt" {% if mode == 'encrypt' %}selected{% endif %}>Enkripsi</option>
        <option value="decrypt" {% if mode == 'decrypt' %}selected{% endif %}>Dekripsi</option>
      </select>

      <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg hover:bg-blue-700">Proses</button>
    </form>

    <!-- Hasil -->
    {% if result %}
    <div class="mt-4 p-3 bg-gray-700 rounded">
      {% if mode == "encrypt" %}
        <p class="font-semibold">Hasil Cipher (Biner):</p>
      {% else %}
        <p class="font-semibold">Hasil Dekripsi (Plaintext):</p>
      {% endif %}
      <p id="cipherResult" class="break-words font-mono">{{ result }}</p>
      <button onclick="copyText()" class="mt-2 px-3 py-1 bg-green-600 rounded hover:bg-green-700">Copy</button>
    </div>

    <div class="mt-4 p-3 bg-gray-800 rounded">
      <p class="font-semibold mb-2">Proses XOR:</p>
      <table class="table-auto w-full text-sm border border-gray-600">
        <thead>
          <tr class="bg-gray-700">
            {% if mode == "encrypt" %}
              <th class="px-2 py-1 border border-gray-600">Plaintext Bit</th>
              <th class="px-2 py-1 border border-gray-600">Keystream</th>
              <th class="px-2 py-1 border border-gray-600">Cipher Bit</th>
            {% else %}
              <th class="px-2 py-1 border border-gray-600">Cipher Bit</th>
              <th class="px-2 py-1 border border-gray-600">Keystream</th>
              <th class="px-2 py-1 border border-gray-600">Plaintext Bit</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for row in proses %}
          <tr>
            {% if mode == "encrypt" %}
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.pt }}</td>
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.ks }}</td>
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.ct }}</td>
            {% else %}
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.ct }}</td>
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.ks }}</td>
              <td class="border border-gray-600 px-2 py-1 font-mono">{{ row.pt }}</td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </div>
</body>
</html>
